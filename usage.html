<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>maven-nar-plugin - Maven NAR Plugin</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                                    
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
                                                        
<script type="text/javascript">_uacct = "UA-140879-1";
        urchinTracker();</script>
                    </head>
  <body class="composite">
    <div id="banner">
                  <a href="" id="bannerLeft">
    
                                    <img src="http://maven.apache.org/images/apache-maven-project-2.png" alt="" />
    
            </a>
                        <a href="http://maven.apache.org/" id="bannerRight">
    
                                    <img src="http://maven.apache.org/images/maven-logo-2.gif" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
            
  
    
            <div class="xleft">
          
                <a href="http://www.apache.org/" class="externalLink">Apache</a>
                &gt;
      
                <a href="http://maven.apache.org/index.html" class="externalLink">Maven</a>
                &gt;
      
                <a href="http://maven.apache.org/plugins/index.html" class="externalLink">Plugins</a>
                &gt;
      
                <a href="http://duns.github.com/maven-nar-plugin/" class="externalLink">Maven NAR Plugin</a>
                  </div>
            <div class="xright">            <a href="http://java.freehep.org/maven1.x/freehep-nar-plugin" class="externalLink">NAR Plugin for Maven1</a>
            |
                <a href="http://maven.apache.org/" class="externalLink">Maven</a>
            
  

  
    
            
  
    
            &nbsp;| Last Published: 2009-12-01
              &nbsp;| Version: 2.1-SNAPSHOT
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
            
  
    
                   <h5>Overview</h5>
            <ul>
              
    <li class="none">
                    <a href="index.html">Introduction</a>
          </li>
              
    <li class="none">
                    <a href="philosophy.html">Philosophy</a>
          </li>
              
    <li class="none">
                    <a href="NARPlugin.ppt">Presentation (ppt)</a>
          </li>
          </ul>
              <h5>User Info</h5>
            <ul>
              
    <li class="none">
                    <a href="plugin-info.html">Goals</a>
          </li>
              
    <li class="none">
              <strong>Usage</strong>
        </li>
              
    <li class="none">
                    <a href="lifecycle.html">Lifecycle</a>
          </li>
              
    <li class="none">
                    <a href="configuration.html">Configuration</a>
          </li>
              
    <li class="none">
                    <a href="faq.html">FAQ</a>
          </li>
              
    <li class="none">
                    <a href="aol.html">AOL Properties</a>
          </li>
              
    <li class="none">
                    <a href="examples.html">Examples</a>
          </li>
          </ul>
              <h5>Developer Info</h5>
            <ul>
              
    <li class="none">
                    <a href="narDependencies.html">NAR Dependencies</a>
          </li>
              
    <li class="none">
                    <a href="https://issues.sonatype.org/browse/NAR" class="externalLink">Bug Reports</a>
          </li>
              
    <li class="none">
                    <a href="http://forum.freehep.org/index.php?t=threadt&frm_id=14&rid=4" class="externalLink">Forum</a>
          </li>
              
    <li class="none">
                    <a href="apidocs/index.html">APIDocs</a>
          </li>
              
    <li class="none">
                    <a href="narLibrary.html">NAR Library</a>
          </li>
              
    <li class="none">
                    <a href="cpptasks.html">CPPTasks</a>
          </li>
              
    <li class="none">
                    <a href="http://github.com/duns/maven-nar-plugin" class="externalLink">Git Browse nar-plugin</a>
          </li>
              
    <li class="none">
                    <a href="http://github.com/duns/cpptasks-parallel" class="externalLink">Git Browse cpptasks</a>
          </li>
              
    <li class="none">
                    <a href="source-repository.html">Git Repository</a>
          </li>
          </ul>
              <h5>Other Information</h5>
            <ul>
              
    <li class="none">
                    <a href="http://docs.codehaus.org/display/MAVEN/Support+for+other+languages" class="externalLink">Maven and other languages</a>
          </li>
          </ul>
                        <h5>Project Documentation</h5>
            <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="project-info.html">Project Information</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="project-reports.html">Project Reports</a>
                </li>
          </ul>
              <h5>Maven Projects</h5>
            <ul>
              
    <li class="none">
                    <a href="http://maven.apache.org/ant-tasks/index.html" class="externalLink">Ant Tasks</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/doxia/index.html" class="externalLink">Doxia</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/jxr/index.html" class="externalLink">JXR</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/maven-1.x/index.html" class="externalLink">Maven 1.x</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/index.html" class="externalLink">Maven 2</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/mercury/index.html" class="externalLink">Mercury</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/plugins/index.html" class="externalLink">Plugins</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/scm/index.html" class="externalLink">SCM</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/shared/index.html" class="externalLink">Shared Components</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/surefire/index.html" class="externalLink">Surefire</a>
          </li>
              
    <li class="none">
                    <a href="http://maven.apache.org/wagon/index.html" class="externalLink">Wagon</a>
          </li>
          </ul>
                                           <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="./images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
            
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Usage</h2>
<p>The following fragments can be used to execute the NAR plugin to compile and link native code.</p>
<div class="section"><h3>Create a Shared Library (but not a JNI library).</h3>
<div class="source"><pre>&lt;project&gt;
  ...
  &lt;packaging&gt;nar&lt;/packaging&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-nar-plugin&lt;/artifactId&gt;
        &lt;version&gt;nar-version-number&lt;/version&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>
</div>
</div>
<div class="section"><h3>Create a JNI Library</h3>
<div class="source"><pre>&lt;project&gt;
  ...
  &lt;packaging&gt;nar&lt;/packaging&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-nar-plugin&lt;/artifactId&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;configuration&gt;
          &lt;libraries&gt;
            &lt;library&gt;
              &lt;type&gt;jni&lt;/type&gt;
              &lt;packageName&gt;com.mycompany.mypackage&lt;/packageName&gt;
            &lt;/library&gt;
          &lt;/libraries&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>
</div>
</div>
<div class="section"><h3>Create a JNI Library without linking to C++</h3>
<p>It is possible to write your JNI code in C++, use the C++ compiler to compile it and then link it only with the C library (as long as you have not used any C++ library calls). Note the two tags to disable exceptions and not link with C++.</p>
<div class="source"><pre>&lt;project&gt;
  ...
  &lt;packaging&gt;nar&lt;/packaging&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-nar-plugin&lt;/artifactId&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;configuration&gt;
          &lt;cpp&gt;
            &lt;exceptions&gt;false&lt;/exceptions&gt;
          &lt;/cpp&gt;
          &lt;libraries&gt;
            &lt;library&gt;
              &lt;type&gt;jni&lt;/type&gt;
              &lt;linkCPP&gt;false&lt;/linkCPP&gt;
            &lt;/library&gt;
          &lt;/libraries&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>
</div>
</div>
<div class="section"><h3>Create a JNI Library using SWIG generated code</h3>
<p>Since SWIG already generated the .h file normally generated by javah, we exclude this file from javah. We also include the compilation and linking with java. The example also shows how to configure the <a href="http://java.freehep.org/freehep-swig-plugin" class="externalLink">freehep-swig-plugin</a>.</p>
<div class="source"><pre>&lt;project&gt;
  ...
  &lt;packaging&gt;nar&lt;/packaging&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.freehep&lt;/groupId&gt;
        &lt;artifactId&gt;freehep-swig-plugin&lt;/artifactId&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;swig&lt;/id&gt;
            &lt;goals&gt;
              &lt;goal&gt;generate&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;cpp&gt;true&lt;/cpp&gt;
              &lt;packageName&gt;org.domain.packagename&lt;/packageName&gt;
              &lt;source&gt;Module.swg&lt;/source&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
      ...
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-nar-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;java&gt;
            &lt;include&gt;true&lt;/include&gt;
          &lt;/java&gt;
          &lt;javah&gt;
            &lt;excludes&gt;
              &lt;exclude&gt;**/ModuleJNI.class&lt;/exclude&gt;
            &lt;/excludes&gt;
          &lt;/javah&gt;
          &lt;libraries&gt;
            &lt;library&gt;
              &lt;type&gt;jni&lt;/type&gt;
            &lt;/library&gt;
          &lt;/libraries&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;    
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>
</div>
</div>
<div class="section"><h3>Assemble libraries made on different platforms for distribution</h3>
<p>This example shows how to download, unpack and assemble the already deployed machine dependent libraries. It also shows the setup of the standard maven-assembly-plugin to pick up the unpacked libraries.</p>
<p>Note there is no &quot;nar&quot; packaging as the normal packaging for assemblies would be &quot;pom&quot;.</p>
<div class="source"><pre>&lt;project&gt;
  ...
  &lt;packaging&gt;pom&lt;/packaging&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
        &lt;!--  NOTE 2.1 fails --&gt;
        &lt;version&gt;2.0.1&lt;/version&gt;
        &lt;configuration&gt;
          &lt;descriptors&gt;
                        ...
            &lt;descriptor&gt;src/main/assembly/x86-Windows-msvc.xml&lt;/descriptor&gt;
            &lt;descriptor&gt;src/main/assembly/ppc-MacOSX-g++.xml&lt;/descriptor&gt;
            &lt;descriptor&gt;src/main/assembly/i386-Linux-g++.xml&lt;/descriptor&gt;
          &lt;/descriptors&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
          ...    
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-nar-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;classifiers&gt;
            &lt;classifier&gt;x86-Windows-msvc&lt;/classifier&gt;
            &lt;classifier&gt;ppc-MacOSX-g++&lt;/classifier&gt;
            &lt;classifier&gt;i386-Linux-g++&lt;/classifier&gt;
          &lt;/classifiers&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;nar-download&lt;/goal&gt;
              &lt;goal&gt;nar-unpack&lt;/goal&gt;
              &lt;goal&gt;nar-assembly&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>
</div>
<p>The i386-Linux-g++ assembly descriptor is below:</p>
<div class="source"><pre>&lt;assembly&gt;
  &lt;id&gt;i386-Linux-g++&lt;/id&gt;
  &lt;formats&gt;
    &lt;format&gt;tar.gz&lt;/format&gt;
  &lt;/formats&gt;
  &lt;fileSets&gt;
    &lt;fileSet&gt;
      &lt;directory&gt;target/nar/lib/i386-Linux-g++/jni&lt;/directory&gt;
      &lt;outputDirectory&gt;lib/i386-Linux-g++&lt;/outputDirectory&gt;      
      &lt;includes&gt;
        &lt;include&gt;*&lt;/include&gt;
      &lt;/includes&gt;
    &lt;/fileSet&gt;
  &lt;/fileSets&gt;
&lt;/assembly&gt;</pre>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2002-2009
    
          The Apache Software Foundation
          
  

  
    
            
  
    
   - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
